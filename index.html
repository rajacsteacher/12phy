<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Fixed Quiz — Working Version</title>
<style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;background:#111;color:#eee;padding:20px}
    .container{max-width:900px;margin:0 auto}
    header{margin-bottom:18px}
    .card{background:#0f1720;padding:18px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,.6)}
    .row{display:flex;gap:12px;align-items:center}
    label{display:block;margin-bottom:6px;color:#9ca3af}
    input,select,button{padding:10px;border-radius:8px;border:1px solid #273244;background:#071022;color:#fff}
    button.primary{background:#2563eb;border-color:transparent;color:#fff;cursor:pointer}
    .hidden{display:none}
    .question{font-size:1.15rem;margin:12px 0;padding:12px;background:#081122;border-radius:8px}
    .options{display:flex;flex-direction:column;gap:8px}
    .option{padding:10px;border-radius:8px;background:#071326;cursor:pointer;border:1px solid #142231}
    .option input{margin-right:8px}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:14px}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>Class 12 Physics — Demo Quiz (Fixed)</h1>
    <p style="color:#9ca3af">This is a working version. The original file's mcqData contained malformed JSON/JS which prevented the script from loading. I've replaced it with a validated set so the quiz starts.</p>
  </header>

  <div class="card" id="form-card">
    <div class="form-row">
      <label for="student-name">Full name</label>
      <input id="student-name" type="text" placeholder="Your name"/>
    </div>
    <div style="height:10px"></div>
    <div class="form-row">
      <label for="school-name">School</label>
      <input id="school-name" type="text" placeholder="School name"/>
    </div>
    <div style="height:10px"></div>
    <div class="form-row">
      <label for="class-section">Class/Section</label>
      <select id="class-section">
        <option value="">Select</option>
        <option value="12A">12A</option>
        <option value="12B">12B</option>
      </select>
    </div>
    <div style="height:12px"></div>
    <button id="start-quiz" class="primary">Start Quiz</button>
  </div>

  <div class="card hidden" id="chapter-card" style="margin-top:16px">
    <h3>Select Chapters</h3>
    <div id="chapters-list"></div>
    <div style="height:12px"></div>
    <button id="show-quiz" class="primary">Show Quiz</button>
  </div>

  <div class="card hidden" id="quiz-card" style="margin-top:16px">
    <div class="row">
      <div>Question <span id="current">1</span> / <span id="total">1</span></div>
      <div style="flex:1"></div>
      <div id="status">Not started</div>
    </div>
    <div class="question" id="question-text"></div>
    <div class="options" id="options"></div>
    <div class="footer">
      <button id="prev-btn">Previous</button>
      <div>
        <button id="next-btn" class="primary">Next</button>
      </div>
    </div>
  </div>

  <div class="card hidden" id="result-card" style="margin-top:16px">
    <h3>Result</h3>
    <p id="result-summary"></p>
    <button id="restart">Restart</button>
  </div>
</div>

<script>
/* ======= CLEAN, VALID mcqData (replaces corrupted original) =======
   If you want the full original dataset restored, please provide a clean JS object
   (the original seemed to contain unescaped quotes/newlines that broke parsing).
*/
const mcqData = {
  "1": [
    { question: "Which charge configuration produces a uniform electric field?", options: ["Point charge", "Infinite uniform line charge", "Uniformly charged infinite plane", "Uniformly charged spherical shell"], answer: 2 },
    { question: "What is the SI unit of electric charge?", options: ["Coulomb", "Volt", "Ohm", "Henry"], answer: 0 }
  ],
  "2": [
    { question: "Ohm's law relates which quantities?", options: ["Voltage and power", "Current and resistance", "Charge and voltage", "Capacitance and voltage"], answer: 1 },
    { question: "A toaster operating at 240 V consumes 1200 W. What is its resistance?", options: ["48 Ω", "28 Ω", "50 Ω", "22 Ω"], answer: 0 }
  ],
  "11": [
    { question: "Electromagnetic waves in vacuum travel at:", options: ["3x10^8 m/s", "1.5x10^8 m/s", "3x10^6 m/s", "3x10^10 m/s"], answer: 0 }
  ]
};

/* ====== App logic (robust) ====== */
const startBtn = document.getElementById('start-quiz');
const showQuizBtn = document.getElementById('show-quiz');
const studentName = document.getElementById('student-name');
const schoolName = document.getElementById('school-name');
const classSection = document.getElementById('class-section');
const chapterCard = document.getElementById('chapter-card');
const chaptersList = document.getElementById('chapters-list');
const formCard = document.getElementById('form-card');
const quizCard = document.getElementById('quiz-card');
const resultCard = document.getElementById('result-card');
const questionText = document.getElementById('question-text');
const optionsEl = document.getElementById('options');
const currentEl = document.getElementById('current');
const totalEl = document.getElementById('total');
const statusEl = document.getElementById('status');
const nextBtn = document.getElementById('next-btn');
const prevBtn = document.getElementById('prev-btn');
const resultSummary = document.getElementById('result-summary');
const restartBtn = document.getElementById('restart');

let selectedChapters = [];
let questions = [];
let idx = 0;
let answers = [];

startBtn.addEventListener('click', () => {
  if (!studentName.value.trim() || !schoolName.value.trim() || !classSection.value) {
    alert('Please fill name, school and class.');
    return;
  }
  // populate chapters list from mcqData keys
  chaptersList.innerHTML = '';
  Object.keys(mcqData).forEach(k => {
    const id = 'ch_' + k;
    const label = document.createElement('label');
    label.style.display = 'block';
    label.innerHTML = `<input type="checkbox" id="${id}" value="${k}"> Chapter ${k}`;
    chaptersList.appendChild(label);
  });
  formCard.classList.add('hidden');
  chapterCard.classList.remove('hidden');
});

showQuizBtn.addEventListener('click', () => {
  const checked = Array.from(chaptersList.querySelectorAll('input[type=checkbox]:checked')).map(i => i.value);
  if (checked.length === 0) { alert('Select at least one chapter'); return; }
  selectedChapters = checked;
  // build questions array
  questions = [];
  selectedChapters.forEach(ch => {
    if (mcqData[ch]) questions = questions.concat(mcqData[ch]);
  });
  if (questions.length === 0) { alert('No questions found for selected chapters'); return; }
  answers = new Array(questions.length).fill(null);
  idx = 0;
  totalEl.textContent = questions.length;
  showQuestion();
  chapterCard.classList.add('hidden');
  quizCard.classList.remove('hidden');
  statusEl.textContent = 'Quiz started';
});

function showQuestion() {
  const q = questions[idx];
  currentEl.textContent = idx + 1;
  questionText.textContent = q.question;
  optionsEl.innerHTML = '';
  q.options.forEach((opt, i) => {
    const div = document.createElement('div');
    div.className = 'option';
    div.innerHTML = `<label><input type="radio" name="opt" value="${i}" ${answers[idx]===i ? 'checked' : ''}> ${opt}</label>`;
    div.addEventListener('click', () => {
      // set answer
      answers[idx] = i;
      // visually mark
      Array.from(optionsEl.children).forEach(c => c.style.borderColor = '#142231');
      div.style.borderColor = '#2563eb';
    });
    optionsEl.appendChild(div);
  });
}

nextBtn.addEventListener('click', () => {
  if (idx < questions.length - 1) {
    idx++;
    showQuestion();
  } else {
    finishQuiz();
  }
});

prevBtn.addEventListener('click', () => {
  if (idx > 0) { idx--; showQuestion(); }
});

function finishQuiz() {
  let correct = 0, wrong = 0, skipped = 0;
  for (let i=0;i<questions.length;i++){
    if (answers[i] === null) skipped++;
    else if (answers[i] === questions[i].answer) correct++;
    else wrong++;
  }
  quizCard.classList.add('hidden');
  resultCard.classList.remove('hidden');
  resultSummary.innerHTML = `
    Name: ${studentName.value} <br>
    School: ${schoolName.value} <br>
    Class: ${classSection.value} <br>
    Chapters: ${selectedChapters.join(', ')} <br>
    Score: ${correct} / ${questions.length} (Correct: ${correct}, Wrong: ${wrong}, Skipped: ${skipped})
  `;
}

restartBtn.addEventListener('click', () => {
  resultCard.classList.add('hidden');
  formCard.classList.remove('hidden');
  chapterCard.classList.add('hidden');
  quizCard.classList.add('hidden');
  studentName.value = '';
  schoolName.value = '';
  classSection.value = '';
});
</script>
</body>
</html>
